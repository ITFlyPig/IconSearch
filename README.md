# IconSearch
### 1、背景
为什么要做这个项目呢？因为在开发过程中，当项目中的图标非常多的时候，新开发需求，涉及图标相关的UI，此时为了判断项目中是否有相同的图标：
1. 有则复用
2. 没有则新增 

我们经常需要手动去一个一个通过人眼的方式排查，耗时不高效还容易遗漏。此时我就在想有没有能通过要处理的图标就能搜索出项目中相同或者相似的图标呢？
经过一番查找，网络上还真没有类似的图标服务，此时我就想到了图标也是图，那利用“以图搜图”的能力不就行了。

所以就有了这个项目。

### 2、项目架构介绍
![j11g86.png](https://files.catbox.moe/j11g86.png)
如图所示，项目主要分为本地和server两部分：
1. **本地部分**：主要是编辑目录收集项目中所有的图标。在该部分有些新奇的地方，比如找遍网络都没有找到很好的能将Android vector drawable转成png的工具，所以
就另辟蹊径，使用kimi 提供的api通过AI先转为svg，在通过cairosvg转成png，而不是使用传统的第三方库的方式。这是AI新起后的新思路，我们有些工作是不是能让AI来做？图片收集好之后就是
通过同步工具将图标同步到服务器。
2. **Server端部分**：该部分主要是将所有的图标通过openai提供的模型向量，并将向量存储到向量数据库Qdrant中。当用户上传图标搜索的时候，先将上传的图标转为向量，然后
使用该向量在向量数据库中搜索到相似的图片，然后返回给用户。这部分比较有意思的的地方就是能通过图片的内容来搜索图片，关键就是将图片转为了向量，最后通过向量来比对。

### 3、项目目录介绍
```
IconSearch
 ├── README.md
 ├── local             // 本地部分
 │   ├── main.py       // 本地部分主入口
 │   ├── log           // 本地部分日志
 │   ├── conf          // 本地程序配置
 │   ├── img           // 本地程序收集到的图片
 │   └── src           // 本地程序源文件
 ├── server            // 服务端部分
 │   ├── conf          // 服务端程序配置
 │   ├── main.py       // 服务端程序主入口
 │   ├── templates     // 服务端Html程序模板文件
 │   ├── log           // 服务端程序日志
 │   ├── src           // 服务端程序源文件
 │   ├── uploads       // 为了搜索用户上传的图片
 │   └── origin_img    // 本地同步上来的图片集合
 └── common            // 本地和服务端程序公用的程序文件
     └── log.py
```
可以看到项目主要是分为两个程序，一个运行在本地收集图标，另一个运行在服务器，提供图标搜索服务。
具体的可以看上面的注释。

### 4、项目运行环境
推荐使用conda创建虚拟环境，安装依赖包，Qdrant通过Docker来跑。下面是比较重要项目运行环境：
* python3.11
* qdrant==1.2.0
* qdrant_client==1.12.0
* cairosvg==2.7.1
具体的依赖可以看environment.yml文件，这是通过conda导出来的。
